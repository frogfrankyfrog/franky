
$(window).load(function(){$(document).on("click",".btnOrder",function(h){h.preventDefault();var g=document.getElementById("chkRule").checked;var i=$('input[class="getMethod"]:checked').val();var j=false;var k=$("#jqpcinfo").data("uc");var d=$("#jqpcinfo").data("u0");var c=$("#jqpcinfo").data("u1");if(i=="0"){if(k<d){swal_function("很抱歉，您的點數不足，無法兌換。","warning");return}}else{if(i=="1"){if(k<c){swal_function("很抱歉，您的點數不足，無法兌換。","warning");return}}}var b={};b.getMethod=i;if(i=="0"){if($(".rName").val().trim()===""){if(g){swal_function("請填寫兌換人資訊","warning");return}}else{j=true}b.rName=$(".rName").val()}if(i=="1"){if($(".rName").val().trim()===""||$(".rPhone").val().trim()===""||$(".rAddress").val().trim()===""||$("#hierarchy").data("send_status")==="false"){if(g){swal_function("請填寫兌換人資訊","warning");return}}else{var f=/09[0-9]{8}/;var a=$(".rPhone").val();if(!f.test(a)){swal_function("手機號碼格式有誤","warning");return}j=true}b.rName=$(".rName").val();b.rPhone=$(".rPhone").val();b.rAddress=$("#hierarchy").data("address")+$(".rAddress").val()}if(!g&&j===false){swal_function("請填寫兌換人資訊，並請先閱讀「爆點福利社兌換規定」，如同意請勾選","warning");return}if(!g){swal_function("請先閱讀「爆點福利社兌換規定」，如同意請勾選","warning");return}b._token=$('meta[name="csrf-token"]').attr("content");b.uuid=$("#uuid").val();b.isLimitedSale=$("#uuid").data("limit");$.post("/shop/order/do",b,function(m){var l=JSON.parse(m);if(l.stat=="ok"){var e={title:"",text:l.msg,html:true,type:"success"};swal(e,function(){window.location.href="/shop"})}if(l.stat=="error"){swal_function(l.msg,"warning")}})})});